<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shano Moodle</title>
</head>
<body>
<script>

  // PASTE THE FOLLOWING SCRIPT IN THE CONSOLE

  const URL = 'https://learn.fmi.uni-sofia.bg/';
  const TEXT = `
Какво е характерно за регистрите с общо предназначение при 64-битов режим?
При Intel-64 архитектурата са EAX, EBX, ECX, EDX, EBP, ESP, ESI и EDI. Тези регистри се използват за съхранението на операндите на логическите и аритметични операции.
<br><br>
Каква е ролята на завършващата част на вътрешната архитектура?
Грижи се за резултатът от изчисленията да съответства на реда на постъпване на инструкции и че състоянието на системата се обновява правилно.
<br><br>
Защитеният режим на процесора.
Той се характеризира с апаратно предотвратяване на достъпа на дадена програма извън границите на заделената и памет.
<br><br>
Обяснете механизма за обновяване на страница от диска.
Мениджърът на паметта използва информацията от таблиците за да намери неизползвана страница физическа памет и я записва в резервирана област на диска, наречена swap файл. После уведомява централния процесор за необходимостта да прочете изискваната страница от по-бавната памет. Накрая MMU установява съответствието между виртуалната и физическата страница и обновява таблицата с тази информация.
<br><br>
Опишете последователността от стъпки, която се изпълнява при прекъсване при IA32
1. Запазва се векторното състояние на текущата програма; 
2. Определя се видът на аварийното събитие или чрез сигнал от линиите за прекъсване, или като код за линиите за данни към процесора; 
3. По кода на вида прекъсване се извлича от оперативната памет нов вектор на състоянието. Старите регистри отиват в друга област – старо състояние. Новото и старото състояние са области в операционната памет; 
4. Преход към нормален цикъл. В резултат на новото съдържание процесорът тръгва от нова команда.
<br><br>
Обяснете групите, на които се делят изключенията.
1. Грешки (faults). Грешките се откриват и обслужват непосредствено преди следващата команда. Най-често се явяват в системата на виртуалната памет, когато е заявен адрес към несъществуваща страница или сегмент. 
2. Капани (traps). Съобщението за капан се генерира непосредствено в края на текущата и преди следващата команда. Капаните това са контролни точки, които могат да бъдат залагани умишлено от потребителя, с цел контрол на изчислителния процес
3. Повреди (аварийни прекъсвания) (aborts). При такива ситуации не винаги се разполага с адреса на командата, по време на която е настъпило изключението. Затова не винаги е възможен рестарт на командата и следователно на хода на изчислителния процес. (апаратни грешки)
<br><br>
GDTR-Обяснете използването на регистъра.
(Global descriptor table register) Този регистър сочи към началния адрес на глобална дескрипторна таблица, която се използва при сегментирания модел на адресация.
<br><br>
Какво е предназначението на сегментните селектори?
Те са 16 битови идентификатори на сегмента. Старшите 13 бита се използват за определяне на отместването в глобалната или локалната дескрипторни таблици.
<br><br>
Как работи изпълняващата част?
Изпълняващата част пренарежда микрооперациите по такъв начин, че тези чиито операнди са готови да се изпълнят възможно по-скоро.
<br><br>
Прилики и разлики между прекъсване и изключение.
Изключението възниква в тялото на текущата програма и се обработва в нея. 
Прекъсванията възникват винаги извън тялото на текущия процес. 
И в двата случая обработката на аварийната ситуация се извършва първо от апаратурата, като централният процесор преминава в авариен цикъл на изпълнение, и след това от софтуерен модул, който обработва данните с цел да намали щетите от възникналото събитие.
<br><br>
Как се осъществява превключване между задачите?
При управлението на задачите освен зареждащия модул (loader) учатсва още един модул за планиране, който решава коя от задачите, заредени в оперативната памет, да активира.
<br><br>
Какво представляват и какви са предимствата на пакетираните SIMD типове данни?
SIMD типовете данни са MMX и XMM. ММХ типът е разработен, за да ускори мултимедийните програми и програмите за комуникация като включват нови инструкции и типове данни които позволяват на програмите да достигат ново ниво на производителност. ММХ типът е разработен като множество от integer инструкции които могат да бъдат приложени към нуждите на голямо разнообразие от мултимедия.
<br><br>
Каква информация се съдържа в IDT?
Таблица на  векторите на прекъсванията (Interrupt Descriptor Table). Тя има 256 елемента. Векторите на прекъсванията не са дескриптори на сегменти, а са входове към такива
<br><br>
По какво се различават изключенията от тип faults и abort
За faults се знае коя инструкция ги е причинила и програмата или процесът могат да бъдат рестартирани без загуба, докато при Aborts това може да не е ясно и следва прекратява на програмата или процесът.
<br><br>
Каква е функцията на челната част (front-end)
Тя съдържа кеша за проследяване, който е кеш за инструкции. За комплексните инструкции кешът за проследяване изпраща указател към ROM, по който се извлича съответната последователност от микрооперации, имплементиращи тази инструкция.
<br><br>
Опишете причините за възникване и стратегиите за предотвратяване на „Мехури“ в инструкционните конвейери.
Всяка команда за преход води до нарушаване на естествената последователност от постъпващи команди в конвейера. Когато не се получава резултат на всеки такт, това състояние да се нарича появяване на мехурчета в работата на конвейера. Преодоляване на проблема са:
предварителен избор на адреса на разклонение;
използване на няколко потока команди;
прогнозирано разклонение; 
отложено разклонение.
<br><br>
Какво представлява сегментната преадресация? Посочете предимства и недостатъци.
При сегментната преадресация логическия адрес (състоящ се от сегментен селектор и сегментно отместване) се преобразуват в линеен адрес.
<br><br>
Какво представлява виртуалната памет и как се поддържа при архитектурата Intel-64?
Виртуална памет е система, при която всичката физическа памет се контролира от операционна система. Когато една програма се нуждае от памет, то тя иска разрешение от операционната система.
<br><br>
Каква информация се съдържа в Task Register и за какво се използва?
Task Register (TR) - съдържа 16 битов сегментен селектор, базов адрес, размер на сегмента и атрибути на Task State Segement (TSS) на текущия процес.
1. Издава команда към процесора за задействането му след даден квант време.
2. Обхожда таблицата на задачите, взима първата, която е в режим на готовност и я стартира, след което продължава по следния начин – записва състоянието на предишната и започва да работи по новата задача.
3. След като изтече квантът време, процесорът е бил задействан от таймер и този вид прекъсване води до активиране на планиращия модул, който отново издава команда за задействане на процесора и отново сканира таблицата
<br><br>
Опишете полетата обособяващи формата на инструкция.
Инструкцията съдържа: незадължително поле префикс, код на операцията (до три байта), спецификатор формиращ адрес (не е задължителен) и съдържа ModR/M байт и понякога а SIB (Scale-Index-Base) байт, отместване (незадължително) и поле „непосредствен“ (незадължително).
<br><br>
Опишете основните класове-инструкции при  IA32
1. Real mode – позволява на процесора да адресира реални адреси от паметта, като максималното адресно пространство е 1М байт
2. Protected mode –нормалният режим на работа. Той позволява използването на сегментиране, виртуална памет и други техники за защита
3. SMM (System management mode) mode – всички обичайни операции се прекратяват и с висок приоритет се изпълнява код, които обикновено е записан на постоянна памет.
<br><br>
Какво е характерно за адресното пространство?
При многозадачните компютърни системи, обикновено не е икономически ефективно, цялото линейното адресно пространство да се съдържа във физическата памет. Необходимо е да се виртуализира линейното адресно пространство, а това се осъществява от процесора с използване на страницирането.
<br><br>
Обяснете по какъв начин се изчислява адреса
Всички сегменти се намират в т.нар. линейно адресно пространство на процесора, а за да се адресира байт в даден сегмент, е необходим логически адрес, които се състои от сегментен селектор и отместване.
<br><br>
Опишете Сегментнит регистри и предназначението им.
Сегментните регистри са 6. Тяхното предназначение е да съхраняват сегментен селектор.
Има различни сегменти.
CS – (Code Segment) – съдържа базовия адрес на сегментът, в който се съхранява програмата.
DS – (Data Segment) – съдържа адреса на сегмента, в който се съхраняват данните.
SS – (Stack Segment)
ES – (Extra Data Segment) – допълнителен сегмент за данни.
FS - Допълнителен сегмент за данни. 
GS - Допълнителен сегмент за данни.
<br><br>
Опишете Флаговите регистри.
съдържа информация за статуса, т.е. изпълнението на програмите
<br><br>
Опишето полето Префикс(Prefix).
Чрез префикса може да се променя поведението на инструкцията, като например да се сменя сегмента, размера на думата, да се управлява цикличното изпълнение и използването на шината.
<br><br>
Пояснете Rex-префикс, използване, приложение и т.н.
Моментна карта на състоянието на страниците на оперативната памет
<br><br>
Обяснете приложението на управляващите регистри.
Управляващите регистри се използват от операционната система.
CR0 - Съдържа флагове контролиращи режимите на работа и състоянието на процесора
CR1 — Запазен, но не се използва.
CR2 – Съдържа линейния адресът, който е причина за изключение от тип „page fault“.
<br><br>
LDTR регистри
Local Descriptor Table Register (LDTR) – съдържа 16 битов сегментен селектор, базов адрес, размер на сегмента и атрибути на дескриптора.
<br><br>
Какви полета съдържа LDT(Local Description Table)
Локалната дескрипторна таблица (Local Descriptor Table LDT) съдържа описание на сегменти, които са частни за дадена програма
<br><br>
Обяснете структура на задачата при IA32
Задачата се състои от пространство за изпълнение (execution space) и сегмент за състоянието на задачата (Task State Segment TSS).
<br><br>
Каква е функцията на предварителното извличане?
Предварителното извличане на данните в кеша (Cache prefetching) е техника, която увеличава производителността, като копира данните от бавна памет в по-бърза, още преди да са необходими.
<br><br>
PCI Bus signals
•	CLK – Clock(33 or 66 MHZ)
•	AD – Multiplexed address and data lines
•	PAR – Adress or data parity biy
•	C/BE – Bus command/bit map for bytes enabled
•	FRAME# - Indicates that AD and C/BE are asserted 
•	IRDY# - Read: master will accept; write: data present
•	IDSEL# - Select configuration space instead of memory
•	DEVSEL#  - Slave has decoded its address and is listening
•	TRDY# - Read: data present; write: slave will accept
•	STOP# - Slave wants to stop transaction immediately
•	PERR# - Data parity error detected by receiver
•	SERR# - Address parity error or system error detected
•	REQ# - Bus arbitration: request for bus ownership
•	GNT# - Bus arbitration: grant of bus ownership
•	RST# - Reset the system and all devices
•	REQ64# - Request to run a 64-bit transaction
•	ACK64# - Permission is granted for a 64-bit transaction
•	AD – Additional 32 bits of address or data
•	PAR64 – Parity for the extra 32 adress/data bits
•	C/BE# - Additional 4 bits for byte enables
•	LOCK – Lock the bus to allow multiple transactions
•	SBO# - Hit on a remote cache(for a multiprocessor)
•	SDONE – Snooping done (for a multiprocessor) 
•	INTx – Reqeust an interrupt
•	JTAG – IEEE 1149.1 JTAG test signals
•	M66EN – Wired to power or ground(66 or 33 MHz)
<br><br>
При Intel архитектурата какво е характерно за регистрите с общо предназначение при 64-битов режим?
Операнди. При работа с 32 битови операнди се използват регистрите EAX, EBX, ECX, EDX, EDI, ESI, EBP, ESP, R8D - R15D. При работа с 64 битови операнди пред обикновената (32 битова) инструкцията се поставя REX префикс и регистрите са съответно RAX,  RBX,  RCX,  RDX,  RDI,  RSI,  RBP,  RSP,  R8-R15.
<br><br>
Каква е ролята на завършващата част (Retirement) на вътрешната архитектура?
Завършващата част се грижи за това, резултатът от изчисленията да съответства на реда на постъпване на инструкции и че състоянието на системата се обновява правилно. След оттеглянето (Retirement) на инструкциите (микрооперациите – μops) за запис, данните се записват в кеш паметта от първо ниво. Следва да се отбележи, че за един цикъл може да се оттеглят (Retire) до три микроинструкции.
<br><br>
Какво е характерно за защитния режим на процесора?
Това е нормалният режим на работа. Той позволява използването на сегментиране, виртуална памет и други техники за защита. В него се влиза при зареждането  на  операционната  система  и изобщо е създаден,  за да  позволи управлението на ресурсите от страна на операционната система. Например, когатодаден процес има нужда от допълнително памет, трябва чрез системно извикване да се обърне към операционната система.
<br><br>
Обяснете механизма за обновяване на страница от диска.
Мениджърът на паметта използва информацията от таблиците за да намери неизползвана страница физическа памет (такава, към която скоро не е имало обръщения) и я записва в резервирана област на диска, наречена swap файл. После уведомява централния процесор за необходимостта да прочете изискваната страница от по-бавната памет (файл на диска или swap файл). Накрая MMU установява съответствието между виртуалната и физическата страница и обновява таблицата с тази информация.
<br><br>
Опишете последователността от стъпки, която се изпълнява при прекъсване в IA-32 архитектурата.
1. Запазва се векторното състояние на текущата програма; 
2. Определя се видът на аварийното събитие или чрез сигнал от линиите за прекъсване, или като код за линиите за данни към процесора; 
3. По кода на вида прекъсване се извлича от оперативната памет нов вектор на състоянието, т.е. се прави зареждане с ново съдържание на централния процесор, включително и program counter-а. Старите регистри отиват в друга област – старо състояние. Новото и старото състояние са области в операционната памет; 
4. Преход към нормален цикъл. В резултат на новото съдържание процесорът тръгва от нова команда. 
Всеки код на прекъсване има програмен модул, който обработва точно тази грешка. Всички тези модули образуват ядрото на операционната система. В зависимост от вида операционна система адресите на тези модули се задават по различен начин. Стандартно за Intel при процесорите има по един вектор на прекъсване, като броят им при IA-32 е 256.
<br><br>
Обяснете групите, на които се делят изключенията.
Изключенията се делят на faults, traps, и aborts в зависимост от начина по който се отчитат и дали инструкцията, която ги е причинила може да бъде рестартирана. За faults и traps се знае коя инструкция ги е причинила и програмата или процесът могат да бъдат рестартирани без загуба, докато при aborts това може да не е ясно и следва прекратяване на програмата или процесът. Капанът (trap) e изключение, при което,след като се изпълни съответната програма за обработка, броячът на инструкциите се увеличава и сочи следващата инструкция. Т.е. текущата програма се прекратява и се продължава със следващата. По този начин например, когато стартирате програма, в която се появи изключение от този тип, то операционната система си връща управлението. За faults се знае коя инструкция ги е причинила и програмата или процесът могат да бъдат рестартирани без загуба, докато при aborts това може да не е ясно и следва прекратяване на програмата или процесът. Изключенията от тип грешки (fault) като цяло могат да бъдат коригирани и затова след като се случат и бъде изпълнена обработващата програма, се стартира отново същата програма (която е генерирала грешката), като се счита, че грешката вече е коригирана (от обработващата програма). За изключенията от тип abort не винаги се знае коя инструкция ги е предизвикала и не позволяват рестартиране на програмата или процесът, които ги причиняват. Използват се за регистриране на хардуерни грешки или недопустими стойности в системни таблици.
<br><br>
Обяснете използването на регистъра GDTR
Global Descriptor Table Register (GDTR) – съдържа базовия адрес (32 бита в защитен и 64 бита в IA-32e режим) и размера (16 бита) на глобалната дескрипторна таблица GDT. instructions load and store the GDTR register. Инструкциите LGDT и SGDT се използват съответно за зареждане и записване стойността на регистъра. Глобалната дескрипторна таблица, която е с 8 байтови елементи, описващи къде се намират сегментите се съхранява в оперативната памет.
<br><br>
Какво е предназначението на сегментните селектори?
Сегментните селектори са 16 битови идентификатори на сегмента. Старшите 13 бита се използват да определяне на отместването в глобалната или локалната дескрипторни таблици. Трите младши бита имат по-специфично предназначение. В зависимост от флага TI се адреси глобална или локална таблица. Полето RPL съдържа необходимото ниво на привилегия, като за да бъде позволен достъп, стойността на (DPL —Descriptor privilege level) трябва да е по-малка или равна от RPL. Всеки сегментен селектор има видима и скрита част, . При първото обръщение към дескриптора се извлича информацията и се записва в скритата част на сегментния регистър. След това се използва, до като не се наложи да се смени сегмента.
<br><br>
Какво представлява сегментната преадресация? Посочете предимства и недостатъци
Управлението на паметта при IA-32 архитектурата се дели на сегментация (segmentation) и странициране (paging). Сегментната преадресация или сегментация предоставя механизъм за изолация на кода, данните и стековите модули, така че множество програми/ процеси да могат да се изпълняват на един и същи процесор, без да се месят взаимно. Би могло да се каже, че сегментацията се осъществява единствено в регистрите на процесора, докато страницирането в паметта. В защитен режим, винаги се използва някакъв вид сегментация и тя няма възможност да се забрани, докато използването на страницирането не е задължително и може да се конфигурира
<br><br>
Какво представлява изпълняващата част (Execution core)
Изпълняващата част пренарежда микрооперациите по такъв начин, че тези чиито операнди са готови (и има налични изчислителни ресурси) да се изпълнят възможно по-скоро. Изпълняващата част може да обработи (issue) няколко микрооперации за един цикъл.
<br><br>
Обяснете приликите и разликите между прекъсване и изключение.
Нарушаването на нормалния цикъл на изпълнение на командата от процесора се нарича особена ситуация. Има два вида особени ситуации – прекъсване и изключение. Изключението възниква в тялото на текущата програма, където работи процесорът, и се обработва в нея. Обикновено това събитие е породено от невъзможността на процесора да извърши текущата команда. (Например в резултат на прехода program counter (програмният брояч) да сочи някъде извън реалната памет или да се окаже, че командата е наред, но има адрес на една от данните, която сочи извън паметта. Други такива команди са: опит за делене на 0; умножение на две големи числа, при което битовете не достигат; опит на програмата да пише в област, в която няма право и др.) Прекъсванията възникват винаги извън тялото на текущия процес, т.е. възникват от входно-изходните устройства, схемите на централния процесор или от други схеми. Тези събития се обработват от операционната система, извън тялото на текущия процес. И в двата случая обработката на аварийната ситуация се извършва първо от апаратурата, като централният процесор преминава в авариен цикъл на изпълнение, и след това от софтуерен модул, който обработва данните с цел да намали щетите от възникналото събитие.
<br><br>
Как се осъществява превключването между задачите при Intel архитектурите?
Операционната система има модул, наречен loader (зареждащ модул), който, получавайки съответна команда, извършва зареждане на задача за предстоящо изпълнение, като при това зареждане в оперативната памет за тази задача се създава споменатия вече (TSS). Освен този модул, при управлението на задачите участва и още един – планиращ модул (модул за планиране), който решава коя от задачите, заредени в оперативната памет, да активира. Той работи на следния принцип:
1) Издава команда към процесора за задействането му след даден квант време.
2) Обхожда таблицата на задачите, взима първата, която е в режим на готовност и я стартира, след което продължава по следния начин – записва състоянието на предишната и започва да работи по новата задача.
3) След като изтече квантът време, процесорът е бил задействан от таймер и този вид прекъсване води до активиране на планиращия модул, който отново издава команда за задействане на процесора и отново сканира таблицата. Има статистическа информация, която пренарежда таблицата, така че да не се позволи една и съща задача да се изпълнява многократно постоянно.
<br><br>
Какво представляват и какви са предимствата на пакетираните SIMD типове данни
SIMD типовете данни са MMX и XMM. ММХ типът е разработен, за да ускори мултимедийните програми и програмите за комуникация като включват нови инструкции и типове данни които позволяват на програмите да достигат ново ниво на производителност. ММХ типът е разработен като множество от integer инструкции които могат да бъдат приложени към нуждите на голямо разнообразие от мултимедия.
<br><br>
Каква информация се съдържа в IDT (Interrupt Description Table)
В Protected mode за всяка програмна част, която се записва някъде, се създава един дескриптор, който представлява таблица на прекъсванията IDT (Interrupt Descriptor Table) и за нея има един регистър, който сочи началото на тази таблица. Когато дойде код на прекъсване, той се разглежда като код на отместване в таблицата, откъдето се определя началото на съответния програмен модул.
<br><br>
По какво се различават изключенията от тип faults и aborts?
За faults се знае коя инструкция ги е причинила и програмата или процесът могат да бъдат рестартирани без загуба, докато при aborts това може да не е ясно и следва прекратяване на програмата или процесът. Изключенията от тип грешки (fault) като цяло могат да бъдат коригирани и затова след като се случат и бъде изпълнена обработващата програма, се стартира отново същата програма (която е генерирала грешката), като се счита, че грешката вече е коригирана (от обработващата програма). За изключенията от тип abort не винаги се знае коя инструкция ги е предизвикала и не позволяват рестартиране на програмата или процесът, които ги причиняват. Използват се за регистриране на хардуерни грешки или недопустими стойности в системни таблици.
<br><br>
Каква информация се съдържа в Task-Register и за какво се използва?
Task Register (TR) - съдържа 16 битов сегментен селектор, както и допълнителна част, в която автоматично се зарежда съдържанието на съответния дескриптор. Това включва базов адрес (32 бита в защитен и 64 бита в IA-32e режим), размер на сегмента и атрибути наTask State Segement (TSS) на текущия процес. Селекторът реферира TSS дескриптор в глобалната таблица GDT. Когатозапочне изпълнението на нов процес (Task) съдържанието на дескриптора се зарежда в скритата час и едва когато се смени процесът, то тогава се променя и сегментния регистър. По този начин, при следващо обръщение (в рамките на същата задача), не е необходимо да се достъпва глобалната таблица. Когато обаче се смени сегментния селектор е необходимо отново да се заредят данните от съответния дескриптор и да се запишат в скритата част (Segment Descriptor Registers).
<br><br>
Какво представлява и каква е функцията на челната част (Front End)?
Челната част се състои от fetch/decode unit, execution trace cache. Челната част извлича и декодира инструкциите. Декодираните инструкции се транслират до микрооперации (μops). Основната задача на тази часте да осигурява непрекъснат поток от микрооперации на изпълняващата част.
<br><br>
<br><br>
<br><br>
`;

  document.body.innerHTML = `
     <style>
        ::-webkit-scrollbar {
          display: none;
        }
      </style>
      <iframe src="${URL}" width="100%" height="100%"></iframe>
      <div id="shano-box" style="position: absolute; bottom: 5px; right: 21px;">
        <input type="checkbox" id="panic" onchange="onPanic(this)" style="opacity: 0.21"/>
        <div id="text-box" style="overflow:scroll; height:300px; width:300px; opacity: 0.3">
          ${TEXT}
        </div>
      </div>
  `;

  document.querySelector('html').style.height = '100%';
  const body = document.querySelector('body');
  body.style.height = '100%';
  body.style.overflow = 'hidden';
  body.style.margin = '0';
  body.style.padding = '0';
  document.querySelector('#panic').checked = true;
  const textBox = document.querySelector('#text-box');

  function onPanic(checkbox) {
    if (checkbox.checked) {
      textBox.style.visibility = 'visible'
    } else {
      textBox.style.visibility = 'hidden'
    }
  }

  // SCRIPT END

</script>
</body>
</html>
